name: Backup databases
on:
  workflow_dispatch:
  schedule:
    # Runs Every day at 4:00am UTC
    - cron: "00 5 * * *"

jobs:
  backup-databases:
    name: Backup databases
    uses: significa/fly-pg-dump-to-s3/.github/workflows/trigger-backup.yaml@v3
    with:
      fly-app: ppbp-db-backup-worker
      machine-size: shared-cpu-1x
      region: iad
      error-on-dangling-volumes: true
      delete-all-volumes: true
    secrets:
      FLY_API_TOKEN: ${{ secrets.FLY_API_TOKEN }}
